fileVersion: 1
id: ff87c947-ada8-496b-819d-e359ec2233d6
name: DT_DIM_ORDERS
operation:
  config:
    advanceWarehouse: false
    backfill: false
    backfillSource: ""
    backfillSourceSchema: ""
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    cpygrants: false
    downstreamOption: false
    immutabilityConstraint: false
    immutableExpression: ""
    initialize: ON_CREATE
    initializeWarehouseSize: ""
    lagSpecification:
      items:
        - lagPeriod: Minutes
          lagValue: "60"
    orderBy:
      items:
        - colName:
            columnCounter: b4bf9d0d-6bf7-4fe7-849e-ccf975f5e009
            stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
    orderByDateTime:
      items:
        - {}
    orderseq:
      items:
        - {}
    partitionBy:
      items:
        - partColName:
            columnCounter: 2287890e-3403-47dd-8f92-20e9825c8158
            stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
    recordVersioning: Datetime Column
    recordorderBy:
      items:
        - {}
    refreshWarehouseSize: ""
    refresh_mode: AUTO
    timeTravel: false
    timeTravelreference: ""
    timeTraveltype: ""
    timeTravelvalue: ""
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: dynamic table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8cd82ec2-537c-4904-8726-1a89311a7dc0
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_ORDERS_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2287890e-3403-47dd-8f92-20e9825c8158
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4923bdb-7282-4377-bcee-0804bfb5afb9
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: defc2a44-0e4b-4c8d-963f-47c1b8c0fde3
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b55c7c3b-219a-40f5-aab5-977ed0a34d6b
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b849122a-570d-4822-8798-702a6b8a4560
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7e7a055-0c89-446c-8d1b-73613d8155c4
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32f6e08d-80a5-4bbd-b001-c125e8de60d8
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdab3396-3604-445f-b027-38efdc100762
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09c0a09f-e017-4db2-9832-c3548e638b82
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dddafe91-e5d2-4def-a9cb-2d4cf596348f
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a4ba09-48cb-4ce7-9c6f-21e9a2070778
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 122051ba-44b1-4fd5-9058-965aac219b37
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e143f34-6385-4f51-94ae-e0c0b0c4f3ac
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5b47fc8-f0f5-49ac-ac94-1952864ce288
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c27cd93-4a37-4883-9aa3-9ed121e3b65c
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 087a9295-7dce-4988-bcaf-c5091c165529
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ab196cb-f9c3-4fec-b164-50923948c7f8
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4712f688-6d01-43be-8af9-23e8b9fc5257
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4bf9d0d-6bf7-4fe7-849e-ccf975f5e009
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: ""
        name: O_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1275f72c-b138-494c-beef-9ff48a66ab55
                stepCounter: 9883692d-e52c-47d4-b294-189e95de72db
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a8bfbbed-d731-407a-8985-b79a78717b17
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 381db29c-045b-4ef4-8357-b0ef87c26848
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f83ef055-4a9d-4b0a-b81c-7a29174d579e
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5cc0a309-4429-4f4c-9cd1-cde752241ea8
          stepCounter: ff87c947-ada8-496b-819d-e359ec2233d6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ORDERS: 9883692d-e52c-47d4-b294-189e95de72db
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_ACC
            nodeName: ORDERS
        join:
          joinCondition: FROM {{ ref('TARGET_ACC', 'ORDERS') }} "ORDERS"
        name: DT_DIM_ORDERS
        noLinkRefs: []
  name: DT_DIM_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: Dynamic-Tables:::350
  type: sql
  version: 1
type: Node
