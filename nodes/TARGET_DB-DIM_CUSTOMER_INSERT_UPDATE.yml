fileVersion: 1
id: b2c169c6-b1df-44db-bfa3-7156d2d086cc
name: DIM_CUSTOMER_INSERT_UPDATE
operation:
  config:
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    customZeroKeyValues:
      items:
        - {}
    groupByAll: false
    insertStrategy: UNION ALL
    insertZeroKey: false
    insertZeroKeyAdvanced: false
    insertZeroKeyBol: "TRUE"
    insertZeroKeyDate: 01-01-1900
    insertZeroKeyStr: UNKNOWN
    insertZeroKeySurrogateKey: "0"
    insertZeroKeyTimestamp: "1900-01-01 00:00:00.000"
    orderby: false
    orderbycolumn:
      items:
        - {}
    postSQL: ""
    preSQL: ""
    selectDistinct: false
    testsEnabled: false
    truncateBefore: false
    updateStrategy: INSERT/UPDATE
  database: ""
  deployEnabled: true
  description: Inserts and updates records in the DIM_CUSTOMER_INSERT_UPDATE dimension table by comparing data from the WRK_CUSTOMER table. A temporary table SRC_STAGE is created to stage the data for these operations.
  isMultisource: false
  locationName: TARGET_DB
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 37f943ff-d1ff-4436-ad14-4d7603dc61bc
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: |-
          - This column is a system-generated surrogate key for the dimension table. 
          - It serves as a unique identifier for each customer record in the data warehouse.
          - As a primary key, it ensures uniqueness and facilitates efficient data retrieval.
          - This key is crucial for joining the customer dimension with fact tables in star schema data models.
          - It is used to track customer-related metrics, reports, and business KPIs.
        isSurrogateKey: true
        name: DIM_CUSTOMER1_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1655af5f-11e2-467d-9705-89ebeb755790
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: NUMBER(38,0)
        description: |-
          - This column represents the customer's key identifier.
          - It originates from the 'C_CUSTKEY' column in the 'WRK_CUSTOMER' source table.
          - It uniquely identifies each customer and serves as a business key.
          - The column plays a crucial role in linking customer information across different systems.
          - It is used in reports, business metrics, and customer-centric analyses.
        isBusinessKey: true
        name: C_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d89775a7-d42d-4d69-84d4-3d557425e9d1
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1db374bf-775c-4d1a-8e7a-2a8416dd599d
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: VARCHAR(25)
        description: |-
          - This column contains the name of the customer.
          - It is sourced from the 'C_NAME' column of the 'WRK_CUSTOMER' table.
          - This attribute provides a descriptive label for identifying customers.
          - It is a core attribute used in customer segmentation, reporting, and analysis.
          - Downstream, this column is used to personalize customer interactions and marketing efforts.
        name: C_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba6afa81-4c27-4d35-9332-c217c938dc4e
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8b3756d-d54f-4164-94e0-73b13b085091
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: VARCHAR(40)
        description: |-
          - This column stores the address of the customer.
          - The data is sourced from the 'C_ADDRESS' column in the 'WRK_CUSTOMER' table.
          - This column is configured for change tracking, which means history of changes to address are tracked.
          - It is used for location-based analysis and targeted marketing campaigns.
          - This information is also critical for logistics, shipping, and other operational aspects.
        isChangeTracking: true
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa36e11c-7fde-4560-a388-ba3069d56894
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f9bef6a-5deb-4cf8-a877-fe64b4aca4f0
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: NUMBER(38,0)
        description: |-
          - This column represents the nation key associated with the customer.
          - It is derived from the 'C_NATIONKEY' column in the 'WRK_CUSTOMER' source table.
          - It links to the nation dimension, facilitating geographical analysis of customer data.
          - It is used in reports and dashboards to analyze customer distribution by nation.
          - This key supports the calculation of nation-specific KPIs and business metrics.
        name: C_NATIONKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61af9bf7-3b0f-4638-8f0a-cf5a79f2d115
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9fac5f2-ece0-4297-852d-b62f05aef54f
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: VARCHAR(15)
        description: |-
          - This column contains the phone number of the customer.
          - It is populated from the 'C_PHONE' column in the 'WRK_CUSTOMER' table.
          - This attribute is used for direct communication with customers.
          - It supports marketing campaigns, customer service, and operational activities.
          - This column enables personalized outreach and facilitates timely customer interactions.
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c41182f-8c8b-4ae5-9405-00f492b91948
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2abc1363-0a96-4a23-b4c8-02b76b8d75cd
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: NUMBER(12,2)
        description: |-
          - This column represents the account balance of the customer.
          - It is sourced from the 'C_ACCTBAL' column of the 'WRK_CUSTOMER' table.
          - This attribute provides financial insights into the customer's relationship.
          - It is used in financial reports, risk assessments, and credit analysis.
          - This data enables the calculation of financial KPIs and profitability metrics.
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1e62d98-f0ef-4e27-9f1e-1c4eec3d61f4
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76ca154f-3485-4777-ae1d-9c46f990c2cb
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: VARCHAR(10)
        description: |-
          - This column indicates the market segment to which the customer belongs.
          - It originates from the 'C_MKTSEGMENT' column in the 'WRK_CUSTOMER' table.
          - This attribute allows for targeted marketing and sales strategies.
          - It supports the analysis of customer behavior and preferences within segments.
          - This column is used for segmentation-based reporting and campaign performance analysis.
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e372e84d-f13f-439d-a5d6-a037415f5259
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd496bc5-2e16-4526-80e0-9d1d2a67ecae
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: VARCHAR(117)
        description: |-
          - This column contains descriptive comments related to the customer.
          - It is sourced from the 'C_COMMENT' column in the 'WRK_CUSTOMER' table.
          - This attribute provides additional context and insights about the customer.
          - It is used in customer service, feedback analysis, and issue resolution.
          - This column allows for a more nuanced understanding of customer needs and behaviors.
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e52d4619-d8f1-4717-bad8-ed6e5a54320a
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9d7f41f-e42d-4d37-9871-13f1ae2a7584
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: |-
          - This column captures the timestamp when the customer record was loaded.
          - It is sourced from the 'C_LOAD_TIMESTAMP' column in the 'WRK_CUSTOMER' table.
          - This attribute provides information on data freshness and load history.
          - It is used for auditing, data quality monitoring, and troubleshooting.
          - The timestamp helps track data updates and ensures data accuracy over time.
        name: C_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2c67b9c-d1ea-4d3d-98dc-714b551b13ac
                stepCounter: 1704ac4a-95f3-4819-81dd-89d5383d8084
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: fe2c25c3-22ae-41e4-85df-b3447c12f30e
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: |-
          - This column is system-generated and represents the version number of the record.
          - It is automatically assigned by the system during data processing.
          - It is used for tracking changes to the record over time for auditing purposes.
          - It is essential for maintaining data integrity and supporting historical analysis.
          - This column ensures that all changes to the record are properly versioned.
        isSystemVersion: true
        name: SYSTEM_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 88a9cd9d-d928-4a06-8718-1f23bf4c667c
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: |-
          - This column is system-generated and indicates if the record is the current version.
          - It is automatically managed by the system during data updates.
          - It simplifies querying for the most up-to-date information.
          - It supports efficient data retrieval and accurate reporting.
          - The flag ensures that only current records are used for real-time analysis.
        isSystemCurrentFlag: true
        name: SYSTEM_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 40a63a10-31e3-41f2-80bb-26f2678f98fd
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: |-
          - This column is system-generated and indicates the timestamp from when the record is valid.
          - It defaults to the current timestamp using the SQL transformation 'CAST(CURRENT_TIMESTAMP AS TIMESTAMP)'.
          - It supports temporal analysis and historical reporting.
          - It is essential for tracking the effective dates of records.
          - This column enables time-sensitive decision-making and trend analysis.
        isSystemStartDate: true
        name: SYSTEM_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: dd3e389e-1bd8-4943-991e-dc1fec0681ee
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: |-
          - This column is system-generated and indicates the timestamp until when the record is valid.
          - It defaults to '2999-12-31 00:00:00' using the SQL transformation 'CAST('2999-12-31 00:00:00' AS TIMESTAMP)'.
          - It supports temporal analysis and historical reporting.
          - It is essential for tracking the expiration dates of records.
          - This column enables time-sensitive decision-making and trend analysis.
        isSystemEndDate: true
        name: SYSTEM_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST('2999-12-31 00:00:00' AS TIMESTAMP)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9a634200-7ef0-4335-83bc-609a21393695
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: |-
          - This column is system-generated and represents the timestamp when the record was created.
          - It defaults to the current timestamp using the SQL transformation 'CAST(CURRENT_TIMESTAMP AS TIMESTAMP)'.
          - It is used for auditing and tracking data lineage.
          - It supports identifying the origin and creation time of records.
          - The timestamp is crucial for data governance and compliance purposes.
        isSystemCreateDate: true
        name: SYSTEM_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 204618d6-eb6c-47b2-bed2-ebd0980d664f
          stepCounter: b2c169c6-b1df-44db-bfa3-7156d2d086cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: |-
          - This column is system-generated and represents the timestamp when the record was last updated.
          - It defaults to the current timestamp using the SQL transformation 'CAST(CURRENT_TIMESTAMP AS TIMESTAMP)'.
          - It is used for auditing and tracking data changes.
          - It supports identifying the last modification time of records.
          - The timestamp is crucial for data quality monitoring and troubleshooting.
        isSystemUpdateDate: true
        name: SYSTEM_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_DB
            nodeName: WRK_CUSTOMER
        join:
          joinCondition: FROM {{ ref('TARGET_DB', 'WRK_CUSTOMER') }} "WRK_CUSTOMER"
        name: DIM_CUSTOMER_INSERT_UPDATE
        noLinkRefs: []
  name: DIM_CUSTOMER_INSERT_UPDATE
  overrideSQL: false
  schema: ""
  sqlType: "388"
  type: sql
  version: 1
type: Node
